{%- comment -%}
  Pills País/Moneda + Idioma (sin JS del tema)
  Parámetros opcionales al render:
    - show_country: true/false (si no se pasa, se activa cuando hay >1 país)
    - show_language: true/false (si no se pasa, se activa cuando hay >1 idioma)
{%- endcomment -%}

{% liquid
  assign _show_country  = show_country
  assign _show_language = show_language

  if _show_country == nil or _show_country == ''
    if localization.available_countries.size > 1
      assign _show_country = true
    else
      assign _show_country = false
    endif
  endif

  if _show_language == nil or _show_language == ''
    if localization.available_languages.size > 1
      assign _show_language = true
    else
      assign _show_language = false
    endif
  endif
%}

<div class="locpill-wrap" role="group" aria-label="Selección de país e idioma">
  {%- if _show_country -%}
    {% form 'localization', id: 'LocPillCountry', class: 'locpill locpill---xxs' %}
      <details class="locpill__details">
        <summary class="locpill__summary" aria-label="Cambiar país y moneda">
          <span class="locpill__flag">
            {% assign cc = localization.country.iso_code | upcase %}
            {%- comment -%} Usa emojis por defecto. Si prefieres SVG en assets: flag-es.svg, flag-us.svg, etc. {%- endcomment -%}
            <span class="locpill__emoji">
              {{ cc
                }}
            </span>
          </span>
          <span class="locpill__label">{{ localization.country.name | upcase }} {{ localization.country.currency.symbol }}</span>
          <span class="locpill__chev" aria-hidden="true">▾</span>
        </summary>

        <div class="locpill__list" role="listbox">
          {%- for country in localization.available_countries -%}
            <button type="submit"
                    name="country_code"
                    value="{{ country.iso_code }}"
                    class="locpill__option"
                    {% if country.iso_code == localization.country.iso_code %}aria-current="true"{% endif %}>
              <span class="locpill__opt-flag">
                <span class="locpill__emoji">
                  {{ country.iso_code | upcase
                     }}
                </span>
              </span>
              <span class="locpill__opt-label">{{ country.name }} {{ country.currency.symbol }}</span>
            </button>
          {%- endfor -%}
        </div>
      </details>
    {% endform %}
  {%- endif -%}

  {%- if _show_language -%}
    {% form 'localization', id: 'LocPillLanguage', class: 'locpill locpill---xxs' %}
      <details class="locpill__details">
        <summary class="locpill__summary" aria-label="Cambiar idioma">
          <span class="locpill__flag"><span class="locpill__emoji"></span></span>
          <span class="locpill__label">{{ localization.language.endonym_name | default: localization.language.name | upcase }}</span>
          <span class="locpill__chev" aria-hidden="true">▾</span>
        </summary>

        <div class="locpill__list" role="listbox">
          {%- for language in localization.available_languages -%}
            <button type="submit"
                    name="locale_code"
                    value="{{ language.iso_code }}"
                    class="locpill__option"
                    {% if language.iso_code == localization.language.iso_code %}aria-current="true"{% endif %}>
              <span class="locpill__opt-label">{{ language.endonym_name | default: language.name }}</span>
            </button>
          {%- endfor -%}
        </div>
      </details>
    {% endform %}
  {%- endif -%}
</div>

<style>
/* --- NUEVO: dos píldoras en la misma línea, sin salto --- */
.locpill-wrap{
  display:inline-flex;          /* se alinea con otros elementos del header */
  align-items:center;
  gap:10px;                     /* separación entre las dos píldoras */
  flex-wrap:nowrap;             /* NO permitir salto de línea */
  white-space:nowrap;           /* evitar cortes del texto */
}

/* Evitar que el form se estire a 100% */
form.locpill{
  display:inline-flex;
  width:auto !important;
  flex:0 0 auto;
  margin:0;
}

/* Asegurar que el trigger ocupa solo su contenido */
.locpill__details{ display:inline-block; }
.locpill__summary{
  display:inline-flex;
  width:auto;
  margin:0;
  white-space:nowrap;
}

/* (Opcional) Si el viewport es MUY estrecho, mejor scroll que salto */
@media (max-width: 380px){
  .locpill-wrap{ overflow-x:auto; -webkit-overflow-scrolling:touch; }
}

</style>