{%- comment -%}
  Pills Pa√≠s/Moneda + Idioma (sin JS del tema)
  Par√°metros opcionales al render:
    - show_country: true/false (si no se pasa, se activa cuando hay >1 pa√≠s)
    - show_language: true/false (si no se pasa, se activa cuando hay >1 idioma)
{%- endcomment -%}

{% liquid
  assign _show_country  = show_country
  assign _show_language = show_language

  if _show_country == nil or _show_country == ''
    if localization.available_countries.size > 1
      assign _show_country = true
    else
      assign _show_country = false
    endif
  endif

  if _show_language == nil or _show_language == ''
    if localization.available_languages.size > 1
      assign _show_language = true
    else
      assign _show_language = false
    endif
  endif
%}

<div class="locpill-wrap" role="group" aria-label="Selecci√≥n de pa√≠s e idioma">
  {%- if _show_country -%}
    {% form 'localization', id: 'LocPillCountry', class: 'locpill locpill--sm' %}
      <details class="locpill__details">
        <summary class="locpill__summary" aria-label="Cambiar pa√≠s y moneda">
          <span class="locpill__flag">
            {% assign cc = localization.country.iso_code | upcase %}
            {%- comment -%} Usa emojis por defecto. Si prefieres SVG en assets: flag-es.svg, flag-us.svg, etc. {%- endcomment -%}
            <span class="locpill__emoji">
              {{ cc
                }}
            </span>
          </span>
          <span class="locpill__label">{{ localization.country.name | upcase }} {{ localization.country.currency.symbol }}</span>
          <span class="locpill__chev" aria-hidden="true">‚ñæ</span>
        </summary>

        <div class="locpill__list" role="listbox">
          {%- for country in localization.available_countries -%}
            <button type="submit"
                    name="country_code"
                    value="{{ country.iso_code }}"
                    class="locpill__option"
                    {% if country.iso_code == localization.country.iso_code %}aria-current="true"{% endif %}>
              <span class="locpill__opt-flag">
                <span class="locpill__emoji">
                  {{ country.iso_code | upcase
                     }}
                </span>
              </span>
              <span class="locpill__opt-label">{{ country.name }} {{ country.currency.symbol }}</span>
            </button>
          {%- endfor -%}
        </div>
      </details>
    {% endform %}
  {%- endif -%}

  {%- if _show_language -%}
    {% form 'localization', id: 'LocPillLanguage', class: 'locpill locpill--sm'' %}
      <details class="locpill__details">
        <summary class="locpill__summary" aria-label="Cambiar idioma">
          <span class="locpill__flag"><span class="locpill__emoji">üåê</span></span>
          <span class="locpill__label">{{ localization.language.endonym_name | default: localization.language.name | upcase }}</span>
          <span class="locpill__chev" aria-hidden="true">‚ñæ</span>
        </summary>

        <div class="locpill__list" role="listbox">
          {%- for language in localization.available_languages -%}
            <button type="submit"
                    name="locale_code"
                    value="{{ language.iso_code }}"
                    class="locpill__option"
                    {% if language.iso_code == localization.language.iso_code %}aria-current="true"{% endif %}>
              <span class="locpill__opt-label">{{ language.endonym_name | default: language.name }}</span>
            </button>
          {%- endfor -%}
        </div>
      </details>
    {% endform %}
  {%- endif -%}
</div>

<style>
/* Wrapper (dos p√≠ldoras en l√≠nea) */
.locpill-wrap{
  display:flex; gap:16px; align-items:center; flex-wrap:wrap;
}

/* Tama√±o peque√±o por defecto */
.locpill--sm{
  --pill-h:26px;       /* alto de la p√≠ldora      */
  --pill-px:12px;      /* padding horizontal       */
  --pill-gap:8px;      /* separaci√≥n interna       */
  --flag-size:20px;    /* di√°metro del icono       */
  --border-w:1.6px;    /* grosor del borde         */
}

/* Base */
.locpill{ position:relative; }
.locpill__details{ position:relative; }

/* Bot√≥n pill */
.locpill__summary{
  list-style:none;
  display:flex; align-items:center; gap:var(--pill-gap);
  height:var(--pill-h); padding:0 var(--pill-px);
  border-radius:9999px; border:var(--border-w) solid #fff;
  background:rgba(255,255,255,.08); /* opcional, sobre fondo rojo queda como en la captura */
  color:#fff; font-weight:600; text-transform:uppercase;
  font-size:12px; line-height:1; cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.locpill__summary::-webkit-details-marker{ display:none; }

/* Icono/flag */
.locpill__flag{
  width:var(--flag-size); height:var(--flag-size);
  border-radius:9999px; overflow:hidden;
  display:grid; place-items:center; flex:0 0 var(--flag-size);
}
.locpill__emoji{ font-size:14px; line-height:1; }

/* Texto y chevron */
.locpill__label{ white-space:nowrap; }
.locpill__chev{ margin-left:auto; font-size:12px; transition:transform .2s; }
.locpill__details[open] .locpill__chev{ transform:rotate(180deg); }

/* Lista desplegable */
.locpill__list{
  position:absolute; top:calc(100% + 8px); left:0; min-width:100%;
  background:#fff; color:#111; border-radius:12px;
  box-shadow:0 8px 30px rgba(0,0,0,.16);
  padding:6px; display:none; z-index:50;
}
.locpill__details[open] .locpill__list{ display:block; }

/* Opciones */
.locpill__option{
  width:100%; display:flex; align-items:center; gap:8px;
  padding:8px 10px; border-radius:8px;
  border:none; background:transparent; cursor:pointer; font-size:13px; text-align:left;
}
.locpill__option:hover{ background:#f2f2f2; }
.locpill__option[aria-current="true"]{ background:#eee; font-weight:600; }

/* Accesibilidad (teclado) */
.locpill__summary:focus-visible,
.locpill__option:focus-visible{
  outline:2px solid #fff; outline-offset:2px;
}

</style>