{% doc %}
  @prompt
    Generate a section exactly the same than "collection heading" but add the functionality that only shows H1 and 2 lines of text and then an accordeon with "read more". But may be readeable to Google this all complete text

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-collection-heading-{{ ai_gen_id }} {
    padding: 40px 0;
    text-align: center;}

  .ai-collection-heading__title-{{ ai_gen_id }} {
    margin: 0 0 20px;
    font-size: {{ block.settings.heading_size }}px;
    color: {{ block.settings.heading_color }};
  }

  .ai-collection-heading__description-{{ ai_gen_id }} {
    max-width: 800px;
    margin: 0 auto;
    font-size: {{ block.settings.text_size }}px;
    color: {{ block.settings.text_color }};
    line-height: 1.6;
  }

  .ai-collection-heading__preview-{{ ai_gen_id }} {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    margin-bottom: 16px;
  }

  .ai-collection-heading__full-text-{{ ai_gen_id }} {
    display: none;
    margin-bottom: 16px;
  }

  .ai-collection-heading__full-text-{{ ai_gen_id }}.active {
    display: block;
  }

  .ai-collection-heading__toggle-{{ ai_gen_id }} {
    background: none;
    border: none;
    color: {{ block.settings.button_color }};
    cursor: pointer;
    font-size: {{ block.settings.text_size }}px;
    text-decoration: underline;
    padding: 0;
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }

  .ai-collection-heading__toggle-{{ ai_gen_id }}:hover {
    color: {{ block.settings.button_hover_color }};
  }

  .ai-collection-heading__icon-{{ ai_gen_id }} {
    width: 16px;
    height: 16px;
    transition: transform 0.3s ease;
  }

  .ai-collection-heading__toggle-{{ ai_gen_id }}.expanded .ai-collection-heading__icon-{{ ai_gen_id }} {
    transform: rotate(180deg);
  }

  .ai-collection-heading__seo-text-{{ ai_gen_id }} {
    position: absolute;
    left: -9999px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }

  @media screen and (max-width: 749px) {
    .ai-collection-heading-{{ ai_gen_id }} {
      padding: 20px 0;
    }

    .ai-collection-heading__title-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.heading_size }}px * 0.8);
    }

    .ai-collection-heading__description-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.text_size }}px * 0.9);
    }
  }
{% endstyle %}

<collection-heading-{{ ai_gen_id }}
  class="ai-collection-heading-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  {% if block.settings.heading != blank %}
    <h1 class="ai-collection-heading__title-{{ ai_gen_id }}">
      {{ block.settings.heading }}
    </h1>
  {% endif %}

  {% if block.settings.description != blank %}
    <div class="ai-collection-heading__description-{{ ai_gen_id }}">
      <div class="ai-collection-heading__preview-{{ ai_gen_id }}">
        {{ block.settings.description }}
      </div>

      <div class="ai-collection-heading__full-text-{{ ai_gen_id }}">
        {{ block.settings.description }}
      </div>

      <div class="ai-collection-heading__seo-text-{{ ai_gen_id }}">
        {{ block.settings.description }}
      </div>

      <button
        class="ai-collection-heading__toggle-{{ ai_gen_id }}"
        aria-expanded="false"
        data-toggle-text-more="{{ block.settings.read_more_text }}"
        data-toggle-text-less="{{ block.settings.read_less_text }}"
      >
        <span class="ai-collection-heading__toggle-text-{{ ai_gen_id }}">
          {{ block.settings.read_more_text }}
        </span>
        <svg
          class="ai-collection-heading__icon-{{ ai_gen_id }}"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polyline points="6,9 12,15 18,9"></polyline>
        </svg>
      </button>
    </div>
  {% endif %}
</collection-heading-{{ ai_gen_id }}>

<script>
  (function() {
    class CollectionHeading{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.toggleButton = this.querySelector('.ai-collection-heading__toggle-{{ ai_gen_id }}');
        this.previewText = this.querySelector('.ai-collection-heading__preview-{{ ai_gen_id }}');
        this.fullText = this.querySelector('.ai-collection-heading__full-text-{{ ai_gen_id }}');
        this.toggleText = this.querySelector('.ai-collection-heading__toggle-text-{{ ai_gen_id }}');

        if (this.toggleButton) {
          this.setupToggle();
        }
      }

      setupToggle() {
        this.toggleButton.addEventListener('click', () => {
          const isExpanded = this.toggleButton.getAttribute('aria-expanded') === 'true';
          
          if (isExpanded) {
            this.previewText.style.display = 'block';
            this.fullText.classList.remove('active');
            this.toggleButton.classList.remove('expanded');
            this.toggleButton.setAttribute('aria-expanded', 'false');
            this.toggleText.textContent = this.toggleButton.dataset.toggleTextMore;
          } else {
            this.previewText.style.display = 'none';
            this.fullText.classList.add('active');
            this.toggleButton.classList.add('expanded');
            this.toggleButton.setAttribute('aria-expanded', 'true');
            this.toggleText.textContent = this.toggleButton.dataset.toggleTextLess;
          }
        });
      }
    }

    customElements.define('collection-heading-{{ ai_gen_id }}', CollectionHeading{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Collection heading",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Collection name"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>This is a detailed description of the collection that will be truncated to two lines initially. Users can click to read more and see the full content. This text remains fully accessible to search engines for SEO purposes.</p>"
    },
    {
      "type": "text",
      "id": "read_more_text",
      "label": "Read more text",
      "default": "Read more"
    },
    {
      "type": "text",
      "id": "read_less_text",
      "label": "Read less text",
      "default": "Read less"
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "range",
      "id": "heading_size",
      "label": "Heading size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "default": 36
    },
    {
      "type": "range",
      "id": "text_size",
      "label": "Text size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button color",
      "default": "#000f9f"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Button hover color",
      "default": "#000000"
    }
  ],
  "presets": [
    {
      "name": "Collection heading"
    }
  ],
  "tag": null
}
{% endschema %}